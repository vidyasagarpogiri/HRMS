<div class="panel panel-info">
  <div class="panel-heading"> 
    Leave History & Current Leaves<%= link_to ' Apply Leave',  new_leave_history_path, :class => "icon-plus-sign pull-right " %>
  </div>
  <% if @leave_histories.present? %> 	 	 	           
    <!-- page start-->
    <div class="row">
      <div class="col-sm-12">
        <section class="panel">
        <header class="panel-heading">            
           <span class="tools pull-right">
              <a href="javascript:;" class="fa fa-chevron-down"></a>
              <a href="javascript:;" class="fa fa-times"></a>
           </span>
        </header>
        <div class="panel-body">
          <div class="adv-table">
            <table  class="display table table-bordered table-striped table-dynamic" id="dynamic-table">
              <thead>
                <tr>			  
				          <th> Date </th>
				          <th>No.of Days</th>
				          <th> Reason </th>
				          <th> Leave Type </th>											
				          <th> Status</th>
				          <th colspan=2>Action</th>							
			         </tr>            
              </thead>
              <tbody >                           
                <%  @leave_histories.each do |f| %>
	           		<% if((f.from_date.to_date <= Date.today && f.to_date.to_date >= Date.today) || (f.to_date.to_date < Date.today)) %>											
			          <tr>               
			            <% if f.is_halfday %>
			              <td><%= f.from_date %></td>
			              <td>half day(<%= f.section %>)</td>               
			             <% else %>
			           	  <td><%= format_date(f.from_date) %> - <%= format_date(f.to_date) %> </td>													
				            <td>  <%= pluralize(f.days, 'day') %>  </td>
				           <% end %>
				          <td><span style='display: none;'><%= f.reason %></span><%= truncate(f.reason) { link_to "Continue", "#", :data => {:toggle => "modal", :target => "#myModal3"}, :id => "modal-text" } %>  </td>
				          <td><%=f.leave_type.type_name %> </td>													
				          <td><%=f.status %></td>
				          <% unless f.to_date.to_date <= Date.today %>
				            <td><%= link_to "Edit", edit_leave_history_path(f),  :class => "btn btn-info", :remote => true  %></td>								 
				          <% end %>
			          </tr>																						
		          </tbody>
              <% end %>	
              <% end %>                                     
              <tfoot>
               <tr>			  
				          <th> Date </th>
				          <th>No.of Days</th>
				          <th> Reason </th>
				          <th> Leave Type </th>											
				          <th> Status</th>
				          <th colspan=2>Action</th>							
			         </tr>          
              </tfoot>
            </table>
          </div>
        </div>
      </section>
      <% else %>
      <div class="alert alert-success alert-dismissable">
          <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
           You have No Leaves History 
      </div>
    <% end %>                            
    </div>
  </div>                          												  									
</div><!--panel panel-info-->							
<script>
$(function(){
  $("td a[id='modal-text']").click(function(){
    var content=$(this).prev().text();
    $("#modal_body-reason3").text(content);
  });
  

});
</script>

<!--common script for all pages-->
    <script src="/assets/common-scripts.js"></script>                                         												 												
							

<!-- Modal -->
<div class="modal hide" id="myModal3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Reason for leave</h4>
      </div>
      <div class="modal-body">
        <span id="modal_body-reason3"></span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
