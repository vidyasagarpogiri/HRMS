<!-- code for edit employee payslips -->

<section class="panel panel-info">
<header class="panel-heading">
PayRoll
</header>

<div class="panel-body">
  <table class="table table-striped table-bordered table-condensed">
    <tr>
      <th>Employee-id</th>
      <th>Employee Name</th>
      <th>Department</th>
    </tr>
    <tr>
      <td><%= @payslip.employee.id %></td>
      <td><%= @payslip.employee.full_name %></td>
      <td><%= @payslip.employee.department.department_name %></td>
    </tr>
  </table>          

  <%= form_tag("/payroll/#{@payslip.id}", method: :put, :remote => true, :class => "payslip-form form-horizontal row-fluid ") do %>
    <div class ="row-fluid">
      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">No.of.Working Days</label>
          <div class="col-lg-8">
            <%= text_field_tag :working_days, (params[:working_days] or @payslip.working_days), :class => "working_days form-control" %>
          </div>
        </div>
      </div>
      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">Arrears</label>
          <div class="col-lg-8">
            <%= text_field_tag :arrears, @payslip.arrears, :class => "arrears form-control" %>
          </div>      
        </div>
      </div>
    </div>

    <div class ="row-fluid">
      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">Gross Salary</label>
          <div class="col-lg-8">
            <%= text_field_tag :gross_salary, (@payslip.gross_salary).round(2), :disabled => true, :class => "form-control" %>
          </div>
        </div>
      </div>
      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">Proffesional Tax</label>
          <div class="controls col-lg-8">
            <%= text_field_tag :pt, @payslip.pt, :class => "pt form-control" %>
          </div>        
        </div>
      </div>
    </div>

    <div class ="row-fluid">
      <div class="span5">
        <div class="form-group">
          <div class="control-group">
            <label class="control-label col-lg-4" for="basicinput">Basic Salary </label>
            <div class="col-lg-8">
              <%= text_field_tag :basic_salary, (@payslip.basic_salary).round(2), :disabled => true, :class => "form-control" %>
            </div>

          </div>
        </div>
      </div>

      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">TDS</label>
          <div class="col-lg-8">
            <%= text_field_tag :tds, @payslip.tds, :class => "tds form-control" %>
          </div> 
        </div>
      </div>
    </div>

    <div class ="row-fluid">
      <div class="span5">
        <div class="form-group">     
          <label class="control-label col-lg-4" for="basicinput">PF</label>
          <div class="col-lg-8">
            <%= text_field_tag :pf, @payslip.pf, :disabled => true, :class => "form-control" %>
          </div>  
        </div>
      </div>
      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">Deductible Arrears</label>
          <div class="col-lg-8">
            <%= text_field_tag :deductible_arrears, @payslip.deductible_arrears, :class => "deductable_arrears form-control" %>
          </div>
        </div>
      </div>
    </div>
    <div class ="row-fluid">
      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">Esic</label>
          <div class="col-lg-8">
            <%= text_field_tag :esic, @payslip.esic, :disabled => true, :class => "form-control" %>
          </div>     
        </div>
      </div>
      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">Total Deductions</label>
          <div class="col-lg-8">
            <%= text_field_tag :total_deductions, @payslip.total_deductions, :disabled => true, :class => "form-control" %>
          </div>
        </div>
      </div>
    </div>
    <div class ="row-fluid">
      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">Pay Mode</label>
          <div class="col-lg-8 salary_mode">
            <select name = "mode_value" class = "form-control mode_option">
              <option value="Bank">Bank</option>
              <option value="Cheque">Cheque</option>
            </select>
          </div>
        </div>
      </div>
      <div class="span5">
        <div class="form-group">
          <label class="control-label col-lg-4" for="basicinput">Net Pay</label>
          <div class="col-lg-8">
            <%= text_field_tag :netpay, (@payslip.netpay).round(2), :disabled => true, :class => "form-control" %>
          </div>
        </div>
      </div>
    </div>

    <%= hidden_field_tag('mode',@payslip.mode) %>                 
    <%= hidden_field_tag('total_working_days',@payslip.no_of_working_days) %>
    <% if @payslip_allowances.present? %>
      <table class="table table-striped table-bordered table-condensed">
        <thead>
          <tr>
            <th>Allowance</th>
            <th>percentage</th>
            <th>value</th>
            <tr/>
            </thead>	
            <tbody>  
              <% @payslip_allowances.each do |allowance| %>  
                <tr>
                  <td><%= allowance.allowance_name %></td>
                  <% if allowance.value.present? %>
                    <td><%= allowance.value %></td>
                    <td><%= allowance.total_value %></td>
                  <% else %>
                    <td>---</td>
                    <td><%= allowance.total_value %></td>
                  <% end %>
                </tr>
              <% end %>
            </tbody>
          </table>
        <% else %>
          <div class="alert alert-danger alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
            No Allowances Applicable For This Payslip 
          </div>
        <% end %>


      <% end %>
      <span class="pull-right">
        <%= link_to 'View PayRoll', "/payroll/#{@payslip.id}", :class => "btn btn-success" %>
      </span>
    </div>
    </section>

    <script>
      $(function(){
        $('.mode_option').val('<%= @payslip.mode %>');   
      });
    </script>

<% title "Pay Roll" %>  

