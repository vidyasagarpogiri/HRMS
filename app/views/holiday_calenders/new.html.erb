<% if @events.present? %>
<div class="wrapper">
 <div class="container">
	<div class="row">

  <div class="span12">
		<div class="content">

			<div class="module">

      <div class="module-head">
        <h3> Add  Holiday calender For : <%= @department.department_name %> Departmant</h3>
      </div>
      <div class="module-body">
        
        <% @holiday_calender.errors.full_messages.each do |error| %>
        <label class="col-lg-3"><%= error %></label>
        <% end %>
        
        
        <%= form_for ([@department, @holiday_calender]), :html => {:class=>"form-horizontal row-fluid"} do |f| %>
             <table class="table table-striped table-hover" id="sample-table-2">
		            <thead>											      
			            <tr>
				            <th class="center">Event name</th>
				            <th> Event Date </th>	
				            <th> Select Events </th> 
				            <th>Mandatory </th>  									      		
			            </tr>
		            </thead>
		             
						    <tbody>
							   <tr>                                       
                                         
               <% @events.each do |event, i| %>
                <%= fields_for "events[]", event do |f| %> 
                  <td><%= event.event_name %></td>
                  <td><%= event.event_date %></td>
                  
                  <% if @department.events.include?(event) %>
                  <td><%= check_box_tag 'event_ids[]', event.id, checked = true %></td>
                  <% else %>
                    <td><%= check_box_tag 'event_ids[]', event.id %></td>
                    
                  <% end %>
                  
                  <% if @department.holiday_calenders.present? && @department.holiday_calenders.find_by_event_id(event.id) %>
                    <% if @department.holiday_calenders.find_by_event_id(event.id).mandatory_or_optional? %>
                      <td><%= check_box_tag 'mandatory[]', event.id, checked = true %></td>
                    <% else %> 
                      <td><%= check_box_tag 'mandatory[]', event.id %></td>
                    <% end %>
                  <% else %>
                     <td><%= check_box_tag 'mandatory[]', event.id %></td>
                  <% end %>
                  
                  
                  </tr>
                 <% end %>
							<% end %>       
	            </tbody>
	            </table> 
	               <%= f.submit  'Save', :class => "btn btn-success" %>&nbsp
                 <%= link_to  "Cancel", leaves_department_path(@department), :class => "btn btn-info pull-right " %>
     <% end %>
						            
	    </div><!--module -body-->
      
 <% else %>
         <div class="alert alert-success alert-dismissable">
           <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
              There Are No Events To Add. Please contact your Administrator
         </div>
<%end%> 
      
  
            </div><!--/.module-->
					</div><!--/.content-->
				</div><!--/.span12-->
			</div><!--/.row-->
		</div><!--/.container-->
	</div><!--/.wrapper--> 
  


          
<script>
  $(function(){
    $(".datepicker").datepicker();
  });
</script>


