<div class="wrapper">
  <div class="container">
    <div class="row">                                             
      <div class="span12">
        <div class="content">
          <div class="module">
            <div class="module-head" style="background-color: #82B4E6 ">
              <h3>pay slips
              </h3>
            </div>
            <div class="processing"></div>
            <div class="module-body">
               <% if @payslips.present? %>                 
                <!-- code for displayin all employees payslips -->   
                <div class="employee_payslip">             
                <table class="table table-striped table-bordered table-condensed">
                   <thead>
                   <tr>
                      <th><strong>PayRoll For <%= Date::MONTHNAMES[@month] %>, <%= @year %></strong></th>
                   </tr>
                   <tr>
                      <th>Employee-Id</th>
                      <th>Name</th>
                      <th>Department</th>
                      <th>Total Working days</th>
                      <th>Basic</th>
                      <th>Gross</th>
                      <th>Total Deductions</th>
                      <th>NetPay</th>
                      <th>Aciton</th>
                    </tr>
                   </thead>
                   <% @payslips.each do |payslip| %>
                   <tbody>
                    <tr>
                      <td><%= payslip.employee.employee_id %></td>
                      <td><%= link_to payslip.employee.full_name, "/payslip/#{payslip.id}" %></td>
                      <td><%= payslip.employee.department.department_name %></td>
                      <td><%= payslip.no_of_working_days%></td>
                      <td><%= payslip.basic_salary%></td>
                       <td><%= payslip.gross_salary %></td>
                      <td><%= payslip.total_deductions %></td>
                      <td><%= payslip.netpay %></td>
                      <td><%= link_to 'Edit', "/payslip/#{payslip.id}/edit", :remote => true %></td>
                   </tbody>
                       <% end %> 
                </table>
                <hr>
                 <%= link_to "Save and Process", salaries_exporting_payslips_excel_sheet_path(:month => @month, :year => @year, :format => "xlsx"), :class => "btn btn-success pull-right save-process" %> 
                </div> 
               
                <% end %>
                <br>  
                        
              </div><br/>
              
            </div><!--/.module-->
               <!-- div for render edit form -->       
               <div class="payslip_edit"></div>
               
             <!-- ***** -->
        </div><!--/.content-->                    
      </div><!--/.span9-->                
    </div><!--/.row-->
  </div><!--/.container-->
</div><!--/.wrapper-->


<script>
  $(function(){
    $(".working_days").change(function(){
      $(".payslip-form").submit();
    });
    $(".arrears").change(function(){
      $(".payslip-form").submit();
    });
    $(".pt").change(function(){
      $(".payslip-form").submit();
    });
    $(".tds").change(function(){
      $(".payslip-form").submit();
    });
    $(".mode_option").change(function(){
      $(".payslip-form").submit();
    });
    
     $(".save-process").click(function(){
      var $saveProcessModal = $('.processing');
      $saveProcessModal.modal('show');
     
    });
    
     $('.processing').hide();
 
  });
</script>

