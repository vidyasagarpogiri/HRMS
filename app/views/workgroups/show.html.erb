<div class="wrapper">
  <div class="container">
    <div class="row">                
      <div class="span12">
        <div class="content">         
				  <div class="module">
					  <div class="module-head">
              <h3> <%= @workgroup.name %> </h3>
              <div class="pull-right" ><a href="/workgroups" style="color:#5ecad4 pull-right"><i class="icon-circle-arrow-left"> Back to Workgroups</i></a></div>   
              <label style="font-weight:normal;margin-top:-20px" class = "pull-right" ><a><i class="icon-plus-sign "></i></a><%= link_to " Add Moderator",add_moderator_workgroup_path %> </label> 
              <a href="#myModal" role="button" class="btn" data-toggle="modal">Add Members</a>     
            </div>
            
            <h5>Group Admin : <%= @employee.full_name %> </h5>
            <div class="module-body">                                                         
                <% if @employees.present? %>                                                                                         
              <table class="table table-striped table-bordered table-condensed">
		            <thead>
			            <tr>
				            <th class="center">Employee Name</th>
				            <th>Role </th>
				            <th> Actions </th>
				            
				          </tr>
		            </thead>
		             <% @employees.each do |em| %> 
		            <tbody>
		            <tr>
				            <th class="center">
				             <%= em.full_name %> 
				            </th>           
				            <th class="center">
				              <% if em.id == @workgroup.admin_id %> 
				                admin  
				              <% elsif WorkgroupsEmployee.where(is_moderator: true, employee_id: em.id, workgroup_id: @workgroup.id).present? %>
				                Moderator
				              <% else %>
				                Member    
				              <% end %>
				            </th>
				            <th>
				            <%  if em.id == @workgroup.admin_id || WorkgroupsEmployee.where(is_moderator: true, employee_id: em.id, workgroup_id: @workgroup.id).present? %>
				            Not Applicable
				            <% else %>
				                <%= link_to "Delete",destroy_member_workgroup_path(@workgroup.id,em.id), method: :delete, data: {confirm: "Are You sure?"}, :class=>"btn btn-danger " %>    
				              <% end %>
				             </th>
				         </tr>
				            <% #raise WorkgroupsEmployee.where(is_moderator: true).inspect %>
				            <%# if current_user.employee.id == @workgroup.admin_id %> 
                     <ul class="navigation-btns  pull-left" >
                        <li><%# link_to 'Edit', :class => "btn btn-success " %></li>
                        <li><%# link_to "Delete",destroy_member_workgroup(workgroup.id), method: :delete, data: {confirm: "Are You sure?"}, :class=>"btn btn-danger " %></li>
                     </ul>
                    
                  <% end %>
				           <% else %>  
							    <div class="alert alert-success alert-dismissable">
                      <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                          No Employees to display
                  </div> 
                                                    
						  <% end %>
						  	
		            </tbody>
                
	            </table> 
	                                                            
            </div><!--module body-->
          </div><!--/.module -->
        </div><!--/.content-->
      </div><!--/.span12-->
    </div><!--/.row-->
  </div><!--/.container-->
</div><!--/.wrapper--> 

<!-- Button to trigger modal -->

 
<!-- Modal -->
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3 id="myModalLabel">Add New Member to Workgroup</h3>
  </div>
  <div class="modal-body">
    <%= render "workgroups/add_member"%>
					
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true"></button>
    <button class="btn btn-primary"></button>
  </div>
</div>      
 
<script>
  $(function() {
  var availableTags = [];
  $.get( "/getAllEmployees.json", function( data ) {
      $.each( data, function( key, val ) {
       availableTags.push(val);
       //alert(val["id"]+" - "+val["value"]);
      });
  });
  
       $( "#member" ).autocomplete({
        minLength: 2,
        source: availableTags,
        focus: function( event, ui ) {
        $( "#member" ).val( ui.item.value );
        
        return false;
        },
        select: function( event, ui ) {
        $( "#member" ).val( ui.item.value );
        $( "#member_id" ).val( ui.item.id );
        return false;
        }
        })
  });
  </script>
  
  <style>
    .ui-autocomplete{
      z-index :5000;
    }
  </style>
  

                     
